{"version":3,"file":"yayudev-ngx-zendesk-webwidget.mjs","sources":["../../../src/lib/ngx-zendesk-webwidget.model.ts","../../../src/lib/ngx-zendesk-webwidget.service.ts","../../../src/lib/ngx-zendesk-webwidget.module.ts","../../../src/yayudev-ngx-zendesk-webwidget.ts"],"sourcesContent":["export abstract class NgxZendeskWebwidgetConfig {\n  lazyLoad: boolean;\n  timeOut: number;\n  injectionTag: 'head' | 'body' | 'script' | string;\n  abstract accountUrl: string;\n  abstract callback(zE: any): any;\n}\n","import { Injectable } from '@angular/core';\n\nimport { NgxZendeskWebwidgetConfig } from './ngx-zendesk-webwidget.model';\n\nfunction getWindow(): any {\n  return window;\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class NgxZendeskWebwidgetService {\n\n  private readonly window: any;\n  private initialized = false;\n  private _zE: any;\n\n  constructor(private ngxZendeskWebwidgetConfig: NgxZendeskWebwidgetConfig) {\n    if (!this.ngxZendeskWebwidgetConfig.accountUrl) {\n      throw new Error('Missing accountUrl. Please set in app config via ZendeskWidgetProvider');\n    }\n\n    this.window = getWindow();\n\n    if (!this.ngxZendeskWebwidgetConfig.lazyLoad) {\n      this.initZendesk();\n    }\n  }\n\n  public initZendesk(): Promise<boolean> {\n    const window = this.window;\n    const config = this.ngxZendeskWebwidgetConfig;\n\n    // tslint:disable\n    window.zEmbed || function(e, t) {\n      let n, o, d, i, s, a = []\n      let r = document.createElement(\"iframe\")\n      window.zEmbed = function() {\n        a.push(arguments)\n      }\n      window.zE = window.zE || window.zEmbed\n      r.src = \"javascript:false\"\n      r.title = \"\"\n      r.style.cssText = \"display: none\"\n      d = document.getElementsByTagName(config.injectionTag || \"head\")\n      d = d[d.length - 1]\n      d.parentNode.insertBefore(r, d)\n      i = r.contentWindow\n      s = i.document\n      try {\n        o = s\n      } catch (e) {\n        n = document.domain\n        r.src = 'javascript:var d=document.open();d.domain=\"' + n + '\";void(0);'\n        o = s\n      }\n      o.open()._l = function() {\n        let e = this.createElement(\"script\")\n        n && (this.domain = n)\n        e.id = \"js-iframe-async\"\n        e.src = \"https://static.zdassets.com/ekr/snippet.js\"\n        this.t += new Date\n        this.zendeskHost = config.accountUrl\n        this.zEQueue = a\n        this.body.appendChild(e)\n      }\n      o.write('<body onload=\"document._l();\">')\n      o.close()\n    }();\n    // tslint:enable\n\n    return this.finishLoading();\n  }\n\n  private finishLoading(): Promise<boolean> {\n    return new Promise<boolean>((resolve, reject) => {\n\n      const timeout = setTimeout(() => {\n        this.initialized = false;\n        reject(Error('timeout'));\n      }, this.ngxZendeskWebwidgetConfig.timeOut || 30000); // 30 seconds\n\n      this.window.zE(() => {\n        this.ngxZendeskWebwidgetConfig.callback(this.window.zE);\n        this.initialized = true;\n        this._zE = this.window.zE;\n        clearTimeout(timeout);\n        resolve(true);\n      });\n    });\n  }\n\n  get isInitialized(): boolean {\n    return this.initialized;\n  }\n\n  get zE(): any {\n    return this._zE\n  }\n}\n","import { NgModule, ModuleWithProviders, Type } from '@angular/core'\nimport { NgxZendeskWebwidgetConfig } from './ngx-zendesk-webwidget.model'\nimport { NgxZendeskWebwidgetService } from './ngx-zendesk-webwidget.service'\n\n@NgModule({})\nexport class NgxZendeskWebwidgetModule {\n  static forRoot(zendeskConfig: Type<NgxZendeskWebwidgetConfig>): ModuleWithProviders<NgxZendeskWebwidgetModule> {\n    return {\n      ngModule: NgxZendeskWebwidgetModule,\n      providers: [\n        {provide: NgxZendeskWebwidgetConfig, useClass: zendeskConfig },\n        {provide: NgxZendeskWebwidgetService, useClass: NgxZendeskWebwidgetService, deps: [NgxZendeskWebwidgetConfig] }\n      ]\n    }\n  }\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"],"names":["i1.NgxZendeskWebwidgetConfig"],"mappings":"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"}